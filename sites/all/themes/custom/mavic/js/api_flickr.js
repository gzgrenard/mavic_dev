/******************************************************************* * function to display a image set in gallery div ******************************************************************/function display_set(data) {	len = data.length;	lightbox.init(data); // init light box	output ="<table id='table_thumb' cellspacing='2px' cellpadding='0px'>";	j=1;	for(i = 0;i<len; i++) {		if(j == 1) output = output + "<tr height='100px'>";		output = output + "<td width='100px' valign='center' bgcolor='#F4F4F4' align='center'><a style='border:0px' href='#' onclick='lightbox.show("+i+");return false;'><img style='border:0px' src=\""+data[i].thumb+"\" /></a></td>";		if(j == 7) {			output = output + "</tr>";			j = 1;		} else {			j++;		}	}	output = output + "</table>";	document.getElementById("gallery").innerHTML = output;	if(len>0){		$("#gallery,#gallerytitle").css({display:'block'});	}}/******************************************************************* * flickr API object ******************************************************************/var flickr_gallery = {		//	// get info about photoset	//	getSetSize : function(photoset_id, callback) {        this._call({            photoset_id: photoset_id,            method: 'flickr.photosets.getInfo'		},callback);    },		//    // get photos from a photoset	//    getSet : function(photoset_id, callback) {        this._find({            photoset_id: photoset_id,			extras: 'url_t, url_m, url_o, url_s, url_l, description',			sort: 'interestingness-desc', // sort option ( date-posted-asc, date-posted-desc, date-taken-asc, date-taken-desc, interestingness-desc, interestingness-asc, relevance )            method: 'flickr.photosets.getPhotos'        }, callback);    },		//    // find all photos by tagname	//    getTags: function(str, callback) {        this._find({			method: 'flickr.photos.search',            extras: 'url_t, url_m, url_o, url_s, url_l, description',            tags: str,            tag_mode: 'all',			user_id: '42558928@N02' // flickr user id (obtain with http://idgettr.com/)        }, callback);    },		//    // call Flickr	//    _call : function(params, callback) {        var url = 'http://api.flickr.com/services/rest/?';        params = $.extend({            format : 'json',            jsoncallback : '?',			api_key: '4af2660daf4fe80e729ad7cbd6589710' // flickr api key        }, params );        $.each(params, function(key, value) {            url += '&' + key + '=' + value;        });        $.getJSON(url, function(data) {            if (data.stat == 'ok') {				callback(data);			}        });    },	//    // ask flickr for photos, parse the result	//    _find : function(params, callback) {        this._call(params, function(data) {            var gallery = [],            photos = data.photos ? data.photos.photo : data.photoset.photo,            len = photos.length;            for (var i=0; i<len; i++) {                var photo = photos[i];				if (photo.url_l) { 					var img_l = photo.url_l;					var height_l = photo.height_l;					var width_l = photo.width_l;				} else if(photo.url_o) {					var img_l = photo.url_o;					var height_l = photo.height_o;					var width_l = photo.width_o;				} else {					var img_l = photo.url_m;					var height_l = photo.height_m;					var width_l = photo.width_m;				}                var item = {                    thumb: photo.url_t,                    image: photo.url_m,					image_small: photo.url_s,					image_big: img_l,					height_l: height_l,					width_l: width_l,                    title: photo.title,                    description: photo.description ? photo.description._content : ''                };                gallery.push(item);            }            callback(gallery);        });    }	};/******************************************************************* * lightbox ******************************************************************/var lightbox = {	listItems : null,	index : null,	currentItem : null,	nbItems : null,	initialCounter : '',	width : 0,    height : 0,		//	// get images list and build lightbox html	//	init : function(items) {				//		// get images		//		this.listItems = items;		this.nbItems = items.length;				//		// get counter text		//		this.initialCounter = document.getElementById('lightbox-counter').innerHTML.replace('YYY',this.nbItems);		/*		var $d = $("#lightbox-prev");		$("#lightbox-prevholder").hover(function() { $d.show();}, 										function() {$d.fadeOut(200);}										).bind('click', function() {lightbox.showPrev();});		$d = $("#lightbox-next");		$("#lightbox-nextholder").hover(function() {$d.show();}, 										function() {$d.fadeOut(200);}										).bind('click', function() {lightbox.showNext();});		*/	},	hide : function() {		$("#lightbox-box").css('display','none');		$("#lightbox-overlay").css('display','none');		$('#footer').css('display','block'); // for IE6		$('#logo').css('display','block'); // for IE	},		overPrev: function() {		if(this.index > 0) {			$("#lightbox-prev").css('display','block');		}	},		overNext: function() {		if((this.index+1) < this.nbItems) {			$("#lightbox-next").css('display','block');		}	},		outPrev: function() {		$("#lightbox-prev").css('display','none');	},		outNext: function() {		$("#lightbox-next").css('display','none');	},	showNext : function() {		if((this.index+1) < this.nbItems) {			this.show(this.index + 1);		}	},	showPrev : function() {		if(this.index > 0) {			this.show(this.index - 1);		}	},	show : function(active) {                                    // go top of page for lightbox                                    $('html, body').animate({ scrollTop: 0 }, 0);                                        		//		// select picture		//		this.index = active;		this.currentItem = this.listItems[active];				//		// hide preview image and show loader		//		$('#logo').css('display','none'); // for IE		$('#footer').css('display','none'); // for IE6		$("#lightbox-box").css('display','none');		$("#lightbox-loader").css('display','block');		$("#lightbox-overlay").css('display','block');				//		// set new data and rescale img		//		document.getElementById("lightbox-title").innerHTML = this.currentItem.title;		document.getElementById("lightbox-counter").innerHTML = this.initialCounter.replace('XXX',this.index + 1);		var imgWidth = parseInt(this.currentItem.width_l), imgHeight = parseInt(this.currentItem.height_l);		var Width = Math.min(imgWidth,getWindowWidth()-40), Height = Math.min(imgHeight,getWindowHeight()-75); // 20 padding around the screen + 35 for title box		var ratio = Math.min(Width / imgWidth, Height / imgHeight);		var destWidth = Math.ceil(ratio*imgWidth),destHeight = Math.ceil(ratio*imgHeight);		var to = {			width: destWidth+"px",			height: (destHeight+35)+"px", // 35 padding for title box			marginTop: Math.ceil((destHeight+35) / 2) * -1 + "px", // 35 padding for title box			marginLeft: Math.ceil(destWidth / 2) * -1 + "px"		};		document.getElementById("lightbox-img").width = destWidth;		document.getElementById("lightbox-img").height = destHeight;		$("#lightbox-box").css(to);				//		// load img and show divs		//		document.getElementById("lightbox-img").onload = function() {			document.getElementById("lightbox-img").onload = "";			$("#lightbox-loader").css('display','none');			$("#lightbox-box").css({display:'block',opacity:0}).animate({opacity:1},500);		}		document.getElementById("lightbox-img").src = this.currentItem.image_big; // lanch onload event after loading	}};// Dependable function to get Window Heightfunction getWindowHeight() {	var windowHeight = 0;	if (typeof(window.innerHeight) == 'number') {		windowHeight = window.innerHeight;	}	else {		if (document.documentElement && document.documentElement.clientHeight) {			windowHeight = document.documentElement.clientHeight;		}		else {			if (document.body && document.body.clientHeight) {				windowHeight = document.body.clientHeight;			}		}	}	return windowHeight;};// Dependable function to get Window Widthfunction getWindowWidth() {	var windowWidth = 0;	if (typeof(window.innerWidth) == 'number') {		windowWidth = window.innerWidth;	}	else {		if (document.documentElement && document.documentElement.clientWidth) {			windowWidth = document.documentElement.clientWidth;		}		else {			if (document.body && document.body.clientWidth) {				windowWidth = document.body.clientWidth;			}		}	}	return windowWidth;};